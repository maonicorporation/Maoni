<script src="./vendors/jquery/dist/jquery.min.js"></script>

<script>


$(function ()
{     
    $('#grp1').addClass('active');
    $('#menu1').show();
    $('#page000').addClass('current-page');
	
	
	
	
	var echartGauge = echarts.init(document.getElementById('echart_guage'), null);

      echartGauge.setOption({
        tooltip: {
          formatter: "{a} <br/>{b} : {c}%"
        },
        toolbox: {
          show: true,
          feature: {
            restore: {
              show: true,
              title: "Restore"
            },
            saveAsImage: {
              show: true,
              title: "Save Image"
            }
          }
        },
        series: [{
          name: 'Performance',
          type: 'gauge',
          center: ['50%', '50%'],
          startAngle: 140,
          endAngle: -140,
          min: 0,
          max: 100,
          precision: 0,
          splitNumber: 10,
          axisLine: {
            show: true,
            lineStyle: {
              color: [
                [0.2, 'lightgreen'],
                [0.4, 'orange'],
                [0.8, 'skyblue'],
                [1, '#ff4500']
              ],
              width: 30
            }
          },
          axisTick: {
            show: true,
            splitNumber: 5,
            length: 8,
            lineStyle: {
              color: '#eee',
              width: 1,
              type: 'solid'
            }
          },
          axisLabel: {
            show: true,
            formatter: function(v) {
              switch (v + '') {
                case '10':
                  return 'a';
                case '30':
                  return 'b';
                case '60':
                  return 'c';
                case '90':
                  return 'd';
                default:
                  return '';
              }
            },
            textStyle: {
              color: '#333'
            }
          },
          splitLine: {
            show: true,
            length: 30,
            lineStyle: {
              color: '#eee',
              width: 2,
              type: 'solid'
            }
          },
          pointer: {
            length: '80%',
            width: 8,
            color: 'auto'
          },
          title: {
            show: true,
            offsetCenter: ['-65%', -10],
            textStyle: {
              color: '#333',
              fontSize: 15
            }
          },
          detail: {
            show: true,
            backgroundColor: 'rgba(0,0,0,0)',
            borderWidth: 0,
            borderColor: '#ccc',
            width: 100,
            height: 40,
            offsetCenter: ['-60%', 10],
            formatter: '{value}%',
            textStyle: {
              color: 'auto',
              fontSize: 30
            }
          },
          data: [{
            value: 50,
            name: 'Performance'
          }]
        }]
      });
});

function query ()
{    
    var idhotel = getCookie("IDHOTEL");
    var fecha = $('#mainFechaDesde').val();
	var desde = null;
	var hasta = null;
	
	
	if (fecha.indexOf("-") != -1)
	{
		var strSplit = fecha.split("-");
		desde = ddmmyyToUnix(strSplit[0]);
		hasta = ddmmyyToUnix(strSplit[1]);
	}
	else
	{
		desde = ddmmyyToUnix(fecha);
		hasta = desde;
	}
    
	$("#cnt1").html("0");
	$("#cnt2").html("0");
	$("#cnt3").html("0");
	$("#cnt4").html("0");
	
    getEncuestasResumenRango (idhotel, desde, hasta, function(err, data)
    {        
        if (data.length == 1)		
		{
			if(data[0].ENVIADAS != null)
			{
				$("#cnt1").html(data[0].ENVIADAS);
			}
			if(data[0].OK != null)
			{
				$("#cnt2").html(data[0].OK);
			}
			if(data[0].KO != null)
			{
				$("#cnt3").html(data[0].KO);
			}
			if(data[0].RATIO != null)
			{
				$("#cnt4").html(data[0].RATIO.toFixed(2) + " %");
			}
		}
    });
	
	getIncidenciasLast5 (idhotel, function(err, data)
    {        		
		$('#idListaTop5').hide (100);
		$('#idListaTop5').empty();
		
        for (var i=0 ; i < data.length; i++)
		{		
			var row = "";
			
			var mm = extractMonthFromYYYYMMDDstring(data[i].FECHACREACION);
			var dd = extractDayFromYYYYMMDDstring(data[i].FECHACREACION);
			
			row += '<article class="media event">';			
			
			if (data[i].SOLUCIONADA != 0)
			{
				row += '	<a class="pull-left date dateok">';
			}
			else
			{
				row += '	<a class="pull-left date dateko">';
			}
			
			var ref = navigateTo ('@@MENU@@_page_010.html', 'rowid=' + data[i].ROWID);
		
			row += '		<p class="month"><b>' + getMonthName(mm) + '</b></p>';
			row += '		<p class="day">' + dd + '</p>';			
			row += '	</a>';
			row += '	<div class="media-body">';
			row += '		<a class="title" href="#">' + data[i].NOMBRE + ' ' + data[i].APELLIDO1 + ' | ' + secondsToString (data[i].ELAPSED) + '</a>';
			row += '		<p>' + data[i].DESCHOTEL + '</p>';
			row += '		<p><b>' + data[i].NOMBRETIPO + ':</b> ' + data[i].DESCRIPCION + '<a href="' + ref + '">&nbsp;&nbsp;&nbsp;<u>más información</u></a></p>';
			row += '	</div>';
			row += '</article>';
			
			$('#idListaTop5').append(row);
		}
		
		$('#idListaTop5').show (200);
    });
	
	
}


</script>


<div class="card-body card-padding">
    
    <div class="row">
        <div class="col-md-2">
            <h4>Vista general</h4>
        </div>
        
		<div class="clearfix"></div>
		
		<div class="row top_tiles">
			<div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
				<div class="tile-stats">
				  <div class="icon"><img src="/img/redondaamarilla.png"></img>
				  </div>
				  <div id="cnt1" class="count">0</div>

				  <h3>Enviadas</h3>
				  <p>Total de encuestas enviadas</p>
				</div>
			</div>
			<div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
				<div class="tile-stats">
				  <div class="icon"><img src="/img/redondaverde.png"></img>
				  </div>
				  <div id="cnt2" class="count">0</div>

				  <h3>Positivas</h3>
				  <p>Total de respuestas positivas</p>
				</div>
			</div>
			<div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
				<div class="tile-stats">
				  <div class="icon"><img src="/img/redondaroja.png"></img>
				  </div>
				  <div id="cnt3" class="count">0</div>

				  <h3>Negativas</h3>
				  <p>Total de respuestas negativas</p>
				</div>
			</div>
			<div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
				<div class="tile-stats">
				  <div class="icon"><img src="/img/redondagris.png"></img>
				  </div>
				  <div id="cnt4" class="count">0</div>

				  <h3>Conversión</h3>
				  <p>% respuestas del total de enviadas</p>
				</div>
			</div>
		
		
		
			<div class="col-md-4 col-sm-4 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>GIS - Global Index Sentiment</h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <div id="echart_guage" style="height:370px;"></div>
                  </div>
                </div>
            </div>
		
			<div class="col-md-4">
				<div class="x_panel">
				  <div class="x_title">
					<h2>Últimas incidencias <small></small></h2>
					<ul class="nav navbar-right panel_toolbox"><br/>
					  <div class="inline boxok"></div><small class="inline">&nbsp;&nbsp;Abierta&nbsp;&nbsp;&nbsp;&nbsp;</small><div class="inline boxko"></div><small class="inline">&nbsp;&nbsp;Solucionadas </small>
					</ul>
					<div class="clearfix"></div>
				  </div>
				  <div class="x_content" id="idListaTop5">
					
					
				  </div>
				</div>
			</div>
			
			
			<div class="col-md-4">
				<div class="x_panel">
				  <div class="x_title">
					<h2>Top resolutivos <small></small></h2>
					<ul class="nav navbar-right panel_toolbox">
					  <small></small>
					</ul>
					<div class="clearfix"></div>
				  </div>
				  <div class="x_content" id="idListaTop5Resolutivos">
					
					<article class="media event">
                      <a class="pull-right date">
                        <p class="month">Nota</p>
                        <p class="day">9.3</p>
                      </a>
					  <a class="pull-left">
                        <img src="http://go.maoni.solutions/users/maoni.jpg" style="max-width: 50%;" alt="..." class="img-rounded img-responsive profile_img" >
                      </a>
					  
                      <div class="media-body">
                        <a class="title" href="#">Item One Title</a>
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                      </div>
                    </article>
					
				  </div>
				</div>
			</div>
			
			
			  
			  
			  
			  
			
			
			</div>
			
    </div>
</div>
